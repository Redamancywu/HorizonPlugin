# HorizonSDKPlugin 更新日志

## v1.0.9 (2025-07-28)

### 性能与稳定性优化

- **HorizonServiceLoader性能优化**：
  - 添加接口继承关系缓存，提高类型兼容性检测效率
  - 实现类缓存机制，减少反射操作，提高模块加载速度
  - 添加模块优先级机制，支持通过@AutoRegisterModule注解设置优先级
  - 优化类扫描算法，提高启动性能
  - 增强线程同步机制，使用CountDownLatch替代轮询等待

- **循环依赖检测**：添加模块间循环依赖检测功能，避免因循环依赖导致的死锁

- **资源处理优化**：
  - 添加资源处理状态跟踪，确保资源只被重命名一次
  - 增加`forceReprocessResources`配置，允许用户控制是否强制重新处理资源
  - 优化资源重命名流程，减少不必要的处理
  - 添加资源映射持久化，确保重启后能保持一致性

### 代码结构优化

- 重构资源处理逻辑，将大函数拆分为小函数，提高可维护性
- 改进错误处理和日志输出
- 增强资源白名单处理功能
- 修改任务执行机制，使用更安全的方法配置任务依赖
- 优化处理XML文件引用的方法，提高并行处理效率
- 增强XML资源处理能力和稳定性
- 改进文件处理和流程控制，避免使用实验性的内联lambda特性

### 兼容性改进

- 修复ResourceIsolationHelper中的方法调用参数不匹配问题
- 修复代码引用分析和资源引用更新功能中的参数错误
- 修复when表达式不完整的问题，确保涵盖所有ResourceNamingStrategy枚举值
- 增强资源回退功能的错误处理
- 优化插件与Gradle兼容性，提高在不同环境下的稳定性

## v1.0.8 (2025-06-02)

### 名称优化
- 将自定义的ServiceLoader类重命名为HorizonServiceLoader，避免与Java标准库的java.util.ServiceLoader混淆
- 更新所有相关文档和示例代码，使用HorizonServiceLoader替代ServiceLoader
- 优化日志输出，使用新的类名

### 功能完善
- 保持所有现有功能不变，仅进行命名优化
- 提高使用体验，避免开发时因类名混淆导致的错误

## v1.0.7 (2025-06-01)

### 架构优化
- 简化插件架构，移除代码生成功能
- 增强ServiceLoader类，提供直接的模块发现和管理能力
- 保留自动注册能力但移除了注册类生成步骤

### 功能增强
- ServiceLoader支持直接扫描类路径查找带有@AutoRegisterModule注解的类
- 添加简单的类路径扫描和注解处理能力
- 优化模块初始化和实例管理流程

### 配置简化
- 移除registerClassName和generatedPackage配置选项
- 保留enableAutoRegister配置以控制自动注册功能
- 简化DSL配置，提高易用性

### 性能优化
- 减少构建依赖，不再依赖KSP生成代码
- 懒加载模块实例，提高运行时性能
- 优化类扫描算法，减少启动开销

## v1.0.5 (2025-05-24)

### 代码结构优化
- 重构插件主类，拆分功能到专门的辅助类
- 创建ManifestMerger专门处理Manifest合并
- 创建ProguardInjector专门处理混淆规则
- 降低代码耦合度，提高可维护性和扩展性

### 功能增强
- 完善代码引用分析，支持更精确的类依赖检测
- 增强日志系统，支持彩色终端输出和文件轮转
- 添加配置验证功能，自动修正无效配置
- 增加资源前缀模板变量支持，更灵活地控制资源命名
- 新增资源命名策略配置，支持前缀/后缀两种模式
- 添加自定义资源前缀/后缀模板，支持动态变量替换
- 新增排除特定资源目录和类型的配置选项
- 增加跨模块资源引用解析能力

### 问题修复
- 修复代码引用分析未捕获内联引用的问题
- 修复Manifest合并冲突无法正确统计的问题
- 修复日志文件路径不存在时的创建问题
- 修复资源隔离在特定情况下可能误处理第三方SDK资源的问题
- 修复资源重命名后ViewBinding属性名不同步的问题

### 性能优化
- 优化类解析算法，提高代码分析性能
- 减少不必要的文件读写操作
- 日志系统使用缓冲模式，减少I/O开销
- 优化资源处理逻辑，大幅提升重命名处理速度
- 资源映射表生成采用增量方式，避免重复处理

### 配置改进
- 资源隔离配置支持更丰富的DSL选项
- 支持通过命令行动态配置资源命名策略和前缀/后缀
- 新增MD5资源命名长度和保留原始名称选项
- 增加资源重命名映射表自定义输出路径配置

## v1.0.4 (2025-05-21)

### 新增功能
- 新增代码引用分析功能
- 支持依赖图生成和未使用类检测
- 支持白名单配置，灵活控制分析范围

### 优化
- 优化代码结构和引用管理
- 添加详细日志输出

## v1.0.3 (2025-05-20)

### 功能增强
- 修复资源引用格式严重错误问题
- 增强资源白名单配置能力
- 提升多Flavor和CI/CD场景下的适配性

### 改进
- 改用正则文本处理替代DOM解析
- 支持更灵活的白名单规则
- 增强日志和错误处理

## v1.0.2 (2025-05-18)

### 新增功能
- 添加资源隔离与自动重命名
- 支持通过命令行设置MD5重命名
- 添加资源引用同步功能

### 改进
- 增强Android Manifest合并功能
- 添加混淆规则自动注入

## v1.0.1 (2025-05-16)

### 新增功能
- 添加自动注册功能
- 支持模块懒加载和初始化控制
- 提供模块状态查询功能

### 改进
- 完善日志系统
- 优化错误处理

## v1.0.0 (2025-05-15)

### 初始版本
- 基础框架搭建
- 支持基本的模块自动注册
- 简单的日志系统 